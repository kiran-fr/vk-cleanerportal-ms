"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CdkExampleStack = void 0;
const cdk = require("@aws-cdk/core");
const lambda = require("@aws-cdk/aws-lambda");
const allLambda_1 = require("./resources/lambda/allLambda");
const apigateway = require("@aws-cdk/aws-apigateway");
const ApiGatewayConstant_1 = require("../constants/ApiGatewayConstant");
const AllApiGateWays_1 = require("./resources/ApiGateway/AllApiGateWays");
const cognito = require("@aws-cdk/aws-cognito");
class CdkExampleStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const userRegistration = new lambda.Function(this, 'UserRegistration', allLambda_1.UserRegistrationLambda());
        const WorksManTermsAndCondition = new lambda.Function(this, 'WorksManTermsAndCondition', allLambda_1.WorksManTermsAndConditionLambda());
        const WorksManExperience = new lambda.Function(this, 'WorksManExperience', allLambda_1.WorksManExperienceLambda());
        const GetWorksmanAccountRegistartionStatus = new lambda.Function(this, "GetWorksmanAccountRegistartionStatus", allLambda_1.GetWorksmanAccountRegistartionStatusLambda());
        const GetTestUser = new lambda.Function(this, "GetTestUser", allLambda_1.GetTestUserLambda());
        const PostTestUser = new lambda.Function(this, "PostTestUser", allLambda_1.PostTestUserLambda());
        const getAllMobileNumbersDemo = new lambda.Function(this, "getAllMobileNumber", allLambda_1.getAllMobileNumberLambda());
        const GetWorkmanDetailLambda = new lambda.Function(this, "GetWorkmanDetails", allLambda_1.GetWorkmanDetailsLambda());
        const UpdateWorksmanDetailLambda = new lambda.Function(this, "UpdateWorksmanDetail", allLambda_1.UpdateWorksmanDetailsLambda());
        const UserPostCodeLambdaApi = new lambda.Function(this, "UserPostCodes", allLambda_1.UserPostCodesLambda());
        const GetAllPostcodesLambdaApi = new lambda.Function(this, "GetAllPostcodes", allLambda_1.GetAllPostcodesLambda());
        const DeletePostcodesLambdaApi = new lambda.Function(this, "DeletePostcodes", allLambda_1.DeletePostcodesLambda());
        const WorksmnaScheduleLambdaApi = new lambda.Function(this, "WorksmnaScheduletcodes", allLambda_1.WorksmnaScheduleLambda());
        const DeleteWorkmanScheduleLambdaApi = new lambda.Function(this, "DeleteWorkmanSchedule", allLambda_1.DeleteWorkmanScheduleLambda());
        const GetWorksmanScheduleLambdaApi = new lambda.Function(this, "GetWorksmanSchedule", allLambda_1.GetWorksmanSchedulesLambda());
        const GetWorksmanjobsLambdaApi = new lambda.Function(this, "GetWorksmanjobs", allLambda_1.GetWorksmanjobsLambda());
        const WorksmanjobsCreateLambdaApi = new lambda.Function(this, "WorksmanjobsCreate", allLambda_1.WorksmanjobsCreateLambda());
        const CreateBankDetailsLambdaApi = new lambda.Function(this, "CreateBankDetails", allLambda_1.CreateBankDetailsLambda());
        const GetBankDetailsLambdaApi = new lambda.Function(this, "GetBankDetails", allLambda_1.GetBankDetailsLambda());
        const CreateMessagesLambdaApi = new lambda.Function(this, "CreateMessages", allLambda_1.CreateMessagesLambda());
        const GetMessagesLambdaApi = new lambda.Function(this, "GetMessages", allLambda_1.GetMessagesLambda());
        const CreateCustomerTableLambdaApi = new lambda.Function(this, "CreateCustomerTable", allLambda_1.CreateCustomerTableLambda());
        const CreateCustomerAddressLambdaApi = new lambda.Function(this, "CreateCustomerAddress", allLambda_1.CreateCustomerAddressLambda());
        const GetJobsLambdaApi = new lambda.Function(this, "GetJobs", allLambda_1.GetJobsLambda());
        const GetPaymentDetailsLambdaApi = new lambda.Function(this, "GetPaymentDetails", allLambda_1.GetPaymentDetailsLambda());
        const CreatePaymentHistoryDetailsLambdaApi = new lambda.Function(this, "CreatePaymentHistoryDetails", allLambda_1.CreatePaymentHistoryDetailsLambda());
        const GetPaymentHistoryDetailsLambdaApi = new lambda.Function(this, "GetPaymentHistoryDetails", allLambda_1.GetPaymentHistoryDetailsLambda());
        const api = new apigateway.RestApi(this, 'WorksManApiDefault', ApiGatewayConstant_1.ApigatewayDataConstants(apigateway));
        const userPool = new cognito.UserPool(this, 'userpool', {
            userPoolName: `vk-clean-portal`,
            removalPolicy: cdk.RemovalPolicy.DESTROY,
            selfSignUpEnabled: true,
            signInAliases: { email: true, phone: true },
            autoVerify: { email: true },
            passwordPolicy: {
                minLength: 6,
                requireLowercase: true,
                requireDigits: true,
                requireUppercase: true,
                requireSymbols: true,
            },
            standardAttributes: {
                givenName: {
                    required: true,
                    mutable: true
                },
                familyName: {
                    required: true,
                    mutable: true
                },
                email: {
                    required: true,
                    mutable: true
                },
                address: {
                    required: true,
                    mutable: true
                },
                birthdate: {
                    required: true,
                    mutable: true
                },
                gender: {
                    required: true,
                    mutable: true
                },
                locale: {
                    required: true,
                    mutable: true
                },
                phoneNumber: {
                    required: true,
                    mutable: true
                },
            },
            accountRecovery: cognito.AccountRecovery.EMAIL_ONLY,
        });
        const standardCognitoAttributes = {
            givenName: true,
            familyName: true,
            email: true,
            address: true,
            birthdate: true,
            gender: true,
            locale: true,
            phoneNumber: true,
        };
        const clientReadAttributes = new cognito.ClientAttributes()
            .withStandardAttributes(standardCognitoAttributes);
        const clientWriteAttributes = new cognito.ClientAttributes()
            .withStandardAttributes({
            ...standardCognitoAttributes,
            emailVerified: false,
            phoneNumberVerified: false,
        });
        const userPoolClient = new cognito.UserPoolClient(this, 'userpool-client', {
            userPool,
            authFlows: {
                adminUserPassword: true,
                custom: true,
                userSrp: true,
                userPassword: true
            },
            supportedIdentityProviders: [
                cognito.UserPoolClientIdentityProvider.COGNITO,
            ],
            readAttributes: clientReadAttributes,
            writeAttributes: clientWriteAttributes,
        });
        new cdk.CfnOutput(this, 'region', { value: cdk.Stack.of(this).region });
        new cdk.CfnOutput(this, 'userPoolId', { value: userPool.userPoolId });
        new cdk.CfnOutput(this, 'userPoolClientId', {
            value: userPoolClient.userPoolClientId,
        });
        new cdk.CfnOutput(this, 'apiUrl', { value: api.url });
        const auth = new apigateway.CognitoUserPoolsAuthorizer(this, 'Authorizer', {
            cognitoUserPools: [userPool]
        });
        // POST APIS
        AllApiGateWays_1.WorksmanTermsAndConditionsApiGateway(api, WorksManTermsAndCondition, 'POST', auth);
        AllApiGateWays_1.worksmanExperienceApiGateway(api, WorksManExperience, 'POST', auth);
        AllApiGateWays_1.PostUserApiGateway(api, PostTestUser, 'POST', auth);
        AllApiGateWays_1.UserPostCodesApiGateway(api, UserPostCodeLambdaApi, 'POST', auth);
        AllApiGateWays_1.WorksmnaScheduleApiGateway(api, WorksmnaScheduleLambdaApi, 'POST', auth);
        AllApiGateWays_1.WorksmanjobsCreateApiGateway(api, WorksmanjobsCreateLambdaApi, 'POST', auth);
        AllApiGateWays_1.CreateBankDetailsApiGateway(api, CreateBankDetailsLambdaApi, 'POST', auth);
        AllApiGateWays_1.CreateMessagesApiGateway(api, CreateMessagesLambdaApi, 'POST', auth);
        AllApiGateWays_1.CreateCustomerTableApiGateway(api, CreateCustomerTableLambdaApi, 'POST', auth);
        AllApiGateWays_1.CreateCustomerAddressApiGateway(api, CreateCustomerTableLambdaApi, 'POST', auth);
        AllApiGateWays_1.CreatePaymentHistoryDetailsApiGateway(api, CreateCustomerTableLambdaApi, 'POST', auth);
        // GET APIS
        AllApiGateWays_1.GetWorksmanAccountRegistartionStatusApiGateway(api, GetWorksmanAccountRegistartionStatus, 'GET', auth);
        AllApiGateWays_1.GetTestUserApiGateway(api, GetTestUser, 'GET', auth);
        AllApiGateWays_1.getAllMobileNumbersApiGateway(api, getAllMobileNumbersDemo, 'GET');
        AllApiGateWays_1.GetWorkmanDetailsApiGateway(api, GetWorkmanDetailLambda, 'GET', auth);
        AllApiGateWays_1.GetAllPostcodesApiGateway(api, GetAllPostcodesLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetWorksmanScheduleApiGateway(api, GetWorksmanScheduleLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetWorksmanjobsApiGateway(api, GetWorksmanjobsLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetBankDetailsApiGateway(api, GetBankDetailsLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetMessagesApiGateway(api, GetMessagesLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetJobsApiGateway(api, GetJobsLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetPaymentDetailsApiGateway(api, GetPaymentDetailsLambdaApi, 'GET', auth);
        AllApiGateWays_1.GetPaymentHistoryDetailsApiGateway(api, GetPaymentHistoryDetailsLambdaApi, 'GET', auth);
        // DELETE APIS
        AllApiGateWays_1.DeletePostcodesApiGateway(api, DeletePostcodesLambdaApi, 'DELETE', auth);
        AllApiGateWays_1.DeleteWorkmanScheduleApiGateway(api, DeleteWorkmanScheduleLambdaApi, 'DELETE', auth);
        // UPDATE APIS
        AllApiGateWays_1.UpdateWorksmanDetailsApiGateway(api, UpdateWorksmanDetailLambda, 'PUT', auth);
    }
}
exports.CdkExampleStack = CdkExampleStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrLWV4YW1wbGUtc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjZGstZXhhbXBsZS1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxxQ0FBcUM7QUFDckMsOENBQThDO0FBQzlDLDREQXVCc0M7QUFHdEMsc0RBQXFEO0FBQ3JELHdFQUEwRTtBQUMxRSwwRUF1QitDO0FBRy9DLGdEQUFnRDtBQUVoRCxNQUFhLGVBQWdCLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFFNUMsWUFBWSxLQUFvQixFQUFFLEVBQVUsRUFBRSxLQUFzQjtRQUNsRSxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixNQUFNLGdCQUFnQixHQUFHLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsa0JBQWtCLEVBQUUsa0NBQXNCLEVBQUUsQ0FBQyxDQUFBO1FBQ2hHLE1BQU0seUJBQXlCLEdBQUcsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSwyQkFBMkIsRUFBRSwyQ0FBK0IsRUFBRSxDQUFDLENBQUE7UUFDM0gsTUFBTSxrQkFBa0IsR0FBRyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLG9CQUFvQixFQUFFLG9DQUF3QixFQUFFLENBQUMsQ0FBQTtRQUN0RyxNQUFNLG9DQUFvQyxHQUFHLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsc0NBQXNDLEVBQUUsc0RBQTBDLEVBQUUsQ0FBQyxDQUFBO1FBQzVKLE1BQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsYUFBYSxFQUFFLDZCQUFpQixFQUFFLENBQUMsQ0FBQTtRQUNqRixNQUFNLFlBQVksR0FBRyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLGNBQWMsRUFBRSw4QkFBa0IsRUFBRSxDQUFDLENBQUE7UUFDcEYsTUFBTSx1QkFBdUIs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LEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQ3JFLHlDQUF3QixDQUFDLEdBQUcsRUFBRSx1QkFBdUIsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFDbkUsc0NBQXFCLENBQUMsR0FBRyxFQUFFLG9CQUFvQixFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUM3RCxrQ0FBaUIsQ0FBQyxHQUFHLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQ3JELDRDQUEyQixDQUFDLEdBQUcsRUFBRSwwQkFBMEIsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFDekUsbURBQWtDLENBQUMsR0FBRyxFQUFFLGlDQUFpQyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUV2RixjQUFjO1FBQ2QsMENBQXlCLENBQUMsR0FBRyxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUN4RSxnREFBK0IsQ0FBQyxHQUFHLEVBQUUsOEJBQThCLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFBO1FBRXBGLGNBQWM7UUFDZCxnREFBK0IsQ0FBQyxHQUFHLEVBQUUsMEJBQTBCLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO0lBRS9FLENBQUM7Q0FDRjtBQWxMRCwwQ0FrTEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjZGsgZnJvbSAnQGF3cy1jZGsvY29yZSc7XHJcbmltcG9ydCAqIGFzIGxhbWJkYSBmcm9tICdAYXdzLWNkay9hd3MtbGFtYmRhJztcclxuaW1wb3J0IHtcclxuICBVc2VyUmVnaXN0cmF0aW9uTGFtYmRhLCBXb3Jrc01hblRlcm1zQW5kQ29uZGl0aW9uTGFtYmRhLCBXb3Jrc01hbkV4cGVyaWVuY2VMYW1iZGEsXHJcbiAgR2V0V29ya3NtYW5BY2NvdW50UmVnaXN0YXJ0aW9uU3RhdHVzTGFtYmRhLCBHZXRUZXN0VXNlckxhbWJkYSwgUG9zdFRlc3RVc2VyTGFtYmRhLCBnZXRBbGxNb2JpbGVOdW1iZXJMYW1iZGEsXHJcbiAgR2V0V29ya21hbkRldGFpbHNMYW1iZGEsXHJcbiAgVXBkYXRlV29ya3NtYW5EZXRhaWxzTGFtYmRhLFxyXG4gIFVzZXJQb3N0Q29kZXNMYW1iZGEsXHJcbiAgR2V0QWxsUG9zdGNvZGVzTGFtYmRhLFxyXG4gIERlbGV0ZVBvc3Rjb2Rlc0xhbWJkYSxcclxuICBXb3Jrc21uYVNjaGVkdWxlTGFtYmRhLFxyXG4gIERlbGV0ZVdvcmttYW5TY2hlZHVsZUxhbWJkYSxcclxuICBHZXRXb3Jrc21hblNjaGVkdWxlc0xhbWJkYSxcclxuICBHZXRXb3Jrc21hbmpvYnNMYW1iZGEsXHJcbiAgV29ya3NtYW5qb2JzQ3JlYXRlTGFtYmRhLFxyXG4gIEdldE1lc3NhZ2VzTGFtYmRhLFxyXG4gIENyZWF0ZU1lc3NhZ2VzTGFtYmRhLFxyXG4gIENyZWF0ZUJhbmtEZXRhaWxzTGFtYmRhLFxyXG4gIEdldEJhbmtEZXRhaWxzTGFtYmRhLFxyXG4gIENyZWF0ZUN1c3RvbWVyVGFibGVMYW1iZGEsXHJcbiAgQ3JlYXRlQ3VzdG9tZXJBZGRyZXNzTGFtYmRhLFxyXG4gIEdldEpvYnNMYW1iZGEsXHJcbiAgR2V0UGF5bWVudERldGFpbHNMYW1iZGEsXHJcbiAgQ3JlYXRlUGF5bWVudEhpc3RvcnlEZXRhaWxzTGFtYmRhLFxyXG4gIEdldFBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYVxyXG59IGZyb20gJy4vcmVzb3VyY2VzL2xhbWJkYS9hbGxMYW1iZGEnO1xyXG5pbXBvcnQgKiBhcyBzZm4gZnJvbSBcIkBhd3MtY2RrL2F3cy1zdGVwZnVuY3Rpb25zXCI7XHJcbmltcG9ydCAqIGFzIHRhc2tzIGZyb20gXCJAYXdzLWNkay9hd3Mtc3RlcGZ1bmN0aW9ucy10YXNrc1wiO1xyXG5pbXBvcnQgKiBhcyBhcGlnYXRld2F5IGZyb20gXCJAYXdzLWNkay9hd3MtYXBpZ2F0ZXdheVwiXHJcbmltcG9ydCB7IEFwaWdhdGV3YXlEYXRhQ29uc3RhbnRzIH0gZnJvbSAnLi4vY29uc3RhbnRzL0FwaUdhdGV3YXlDb25zdGFudCc7XHJcbmltcG9ydCB7XHJcbiAgV29ya3NtYW5UZXJtc0FuZENvbmRpdGlvbnNBcGlHYXRld2F5LCBQb3N0VXNlckFwaUdhdGV3YXksIGdldEFsbE1vYmlsZU51bWJlcnNBcGlHYXRld2F5LFxyXG4gIHdvcmtzbWFuRXhwZXJpZW5jZUFwaUdhdGV3YXksIEdldFdvcmtzbWFuQWNjb3VudFJlZ2lzdGFydGlvblN0YXR1c0FwaUdhdGV3YXksIEdldFRlc3RVc2VyQXBpR2F0ZXdheSxcclxuICBHZXRXb3JrbWFuRGV0YWlsc0FwaUdhdGV3YXksXHJcbiAgVXBkYXRlV29ya3NtYW5EZXRhaWxzQXBpR2F0ZXdheSxcclxuICBVc2VyUG9zdENvZGVzQXBpR2F0ZXdheSxcclxuICBHZXRBbGxQb3N0Y29kZXNBcGlHYXRld2F5LFxyXG4gIERlbGV0ZVBvc3Rjb2Rlc0FwaUdhdGV3YXksXHJcbiAgV29ya3NtbmFTY2hlZHVsZUFwaUdhdGV3YXksXHJcbiAgRGVsZXRlV29ya21hblNjaGVkdWxlQXBpR2F0ZXdheSxcclxuICBHZXRXb3Jrc21hblNjaGVkdWxlQXBpR2F0ZXdheSxcclxuICBHZXRXb3Jrc21hbmpvYnNBcGlHYXRld2F5LFxyXG4gIFdvcmtzbWFuam9ic0NyZWF0ZUFwaUdhdGV3YXksXHJcbiAgR2V0TWVzc2FnZXNBcGlHYXRld2F5LFxyXG4gIENyZWF0ZU1lc3NhZ2VzQXBpR2F0ZXdheSxcclxuICBDcmVhdGVCYW5rRGV0YWlsc0FwaUdhdGV3YXksXHJcbiAgR2V0QmFua0RldGFpbHNBcGlHYXRld2F5LFxyXG4gIENyZWF0ZUN1c3RvbWVyVGFibGVBcGlHYXRld2F5LFxyXG4gIENyZWF0ZUN1c3RvbWVyQWRkcmVzc0FwaUdhdGV3YXksXHJcbiAgR2V0Sm9ic0FwaUdhdGV3YXksXHJcbiAgR2V0UGF5bWVudERldGFpbHNBcGlHYXRld2F5LFxyXG4gIENyZWF0ZVBheW1lbnRIaXN0b3J5RGV0YWlsc0FwaUdhdGV3YXksXHJcbiAgR2V0UGF5bWVudEhpc3RvcnlEZXRhaWxzQXBpR2F0ZXdheVxyXG59IGZyb20gXCIuL3Jlc291cmNlcy9BcGlHYXRld2F5L0FsbEFwaUdhdGVXYXlzXCI7XHJcbmltcG9ydCAqIGFzIGFwaUdhdGV3YXlBdXRob3JpemVycyBmcm9tICdAYXdzLWNkay9hd3MtYXBpZ2F0ZXdheXYyLWF1dGhvcml6ZXJzJztcclxuaW1wb3J0ICogYXMgYXBpR2F0ZXdheUludGVncmF0aW9ucyBmcm9tICdAYXdzLWNkay9hd3MtYXBpZ2F0ZXdheXYyLWludGVncmF0aW9ucyc7XHJcbmltcG9ydCAqIGFzIGNvZ25pdG8gZnJvbSAnQGF3cy1jZGsvYXdzLWNvZ25pdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIENka0V4YW1wbGVTdGFjayBleHRlbmRzIGNkay5TdGFjayB7XHJcbiAgcHVibGljIE1hY2hpbmU6IHNmbi5TdGF0ZU1hY2hpbmU7XHJcbiAgY29uc3RydWN0b3Ioc2NvcGU6IGNkay5Db25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzPzogY2RrLlN0YWNrUHJvcHMpIHtcclxuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xyXG5cclxuICAgIGNvbnN0IHVzZXJSZWdpc3RyYXRpb24gPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsICdVc2VyUmVnaXN0cmF0aW9uJywgVXNlclJlZ2lzdHJhdGlvbkxhbWJkYSgpKVxyXG4gICAgY29uc3QgV29ya3NNYW5UZXJtc0FuZENvbmRpdGlvbiA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgJ1dvcmtzTWFuVGVybXNBbmRDb25kaXRpb24nLCBXb3Jrc01hblRlcm1zQW5kQ29uZGl0aW9uTGFtYmRhKCkpXHJcbiAgICBjb25zdCBXb3Jrc01hbkV4cGVyaWVuY2UgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsICdXb3Jrc01hbkV4cGVyaWVuY2UnLCBXb3Jrc01hbkV4cGVyaWVuY2VMYW1iZGEoKSlcclxuICAgIGNvbnN0IEdldFdvcmtzbWFuQWNjb3VudFJlZ2lzdGFydGlvblN0YXR1cyA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJHZXRXb3Jrc21hbkFjY291bnRSZWdpc3RhcnRpb25TdGF0dXNcIiwgR2V0V29ya3NtYW5BY2NvdW50UmVnaXN0YXJ0aW9uU3RhdHVzTGFtYmRhKCkpXHJcbiAgICBjb25zdCBHZXRUZXN0VXNlciA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJHZXRUZXN0VXNlclwiLCBHZXRUZXN0VXNlckxhbWJkYSgpKVxyXG4gICAgY29uc3QgUG9zdFRlc3RVc2VyID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIlBvc3RUZXN0VXNlclwiLCBQb3N0VGVzdFVzZXJMYW1iZGEoKSlcclxuICAgIGNvbnN0IGdldEFsbE1vYmlsZU51bWJlcnNEZW1vID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcImdldEFsbE1vYmlsZU51bWJlclwiLCBnZXRBbGxNb2JpbGVOdW1iZXJMYW1iZGEoKSlcclxuICAgIGNvbnN0IEdldFdvcmttYW5EZXRhaWxMYW1iZGEgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsIFwiR2V0V29ya21hbkRldGFpbHNcIiwgR2V0V29ya21hbkRldGFpbHNMYW1iZGEoKSlcclxuICAgIGNvbnN0IFVwZGF0ZVdvcmtzbWFuRGV0YWlsTGFtYmRhID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIlVwZGF0ZVdvcmtzbWFuRGV0YWlsXCIsIFVwZGF0ZVdvcmtzbWFuRGV0YWlsc0xhbWJkYSgpKVxyXG4gICAgY29uc3QgVXNlclBvc3RDb2RlTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIlVzZXJQb3N0Q29kZXNcIiwgVXNlclBvc3RDb2Rlc0xhbWJkYSgpKVxyXG4gICAgY29uc3QgR2V0QWxsUG9zdGNvZGVzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkdldEFsbFBvc3Rjb2Rlc1wiLCBHZXRBbGxQb3N0Y29kZXNMYW1iZGEoKSlcclxuICAgIGNvbnN0IERlbGV0ZVBvc3Rjb2Rlc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJEZWxldGVQb3N0Y29kZXNcIiwgRGVsZXRlUG9zdGNvZGVzTGFtYmRhKCkpXHJcbiAgICBjb25zdCBXb3Jrc21uYVNjaGVkdWxlTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIldvcmtzbW5hU2NoZWR1bGV0Y29kZXNcIiwgV29ya3NtbmFTY2hlZHVsZUxhbWJkYSgpKVxyXG4gICAgY29uc3QgRGVsZXRlV29ya21hblNjaGVkdWxlTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkRlbGV0ZVdvcmttYW5TY2hlZHVsZVwiLCBEZWxldGVXb3JrbWFuU2NoZWR1bGVMYW1iZGEoKSlcclxuICAgIGNvbnN0IEdldFdvcmtzbWFuU2NoZWR1bGVMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsIFwiR2V0V29ya3NtYW5TY2hlZHVsZVwiLCBHZXRXb3Jrc21hblNjaGVkdWxlc0xhbWJkYSgpKVxyXG4gICAgY29uc3QgR2V0V29ya3NtYW5qb2JzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkdldFdvcmtzbWFuam9ic1wiLCBHZXRXb3Jrc21hbmpvYnNMYW1iZGEoKSlcclxuICAgIGNvbnN0IFdvcmtzbWFuam9ic0NyZWF0ZUxhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJXb3Jrc21hbmpvYnNDcmVhdGVcIiwgV29ya3NtYW5qb2JzQ3JlYXRlTGFtYmRhKCkpXHJcbiAgICBjb25zdCBDcmVhdGVCYW5rRGV0YWlsc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJDcmVhdGVCYW5rRGV0YWlsc1wiLCBDcmVhdGVCYW5rRGV0YWlsc0xhbWJkYSgpKVxyXG4gICAgY29uc3QgR2V0QmFua0RldGFpbHNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsIFwiR2V0QmFua0RldGFpbHNcIiwgR2V0QmFua0RldGFpbHNMYW1iZGEoKSlcclxuICAgIGNvbnN0IENyZWF0ZU1lc3NhZ2VzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkNyZWF0ZU1lc3NhZ2VzXCIsIENyZWF0ZU1lc3NhZ2VzTGFtYmRhKCkpXHJcbiAgICBjb25zdCBHZXRNZXNzYWdlc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJHZXRNZXNzYWdlc1wiLCBHZXRNZXNzYWdlc0xhbWJkYSgpKVxyXG4gICAgY29uc3QgQ3JlYXRlQ3VzdG9tZXJUYWJsZUxhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJDcmVhdGVDdXN0b21lclRhYmxlXCIsIENyZWF0ZUN1c3RvbWVyVGFibGVMYW1iZGEoKSlcclxuICAgIGNvbnN0IENyZWF0ZUN1c3RvbWVyQWRkcmVzc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJDcmVhdGVDdXN0b21lckFkZHJlc3NcIiwgQ3JlYXRlQ3VzdG9tZXJBZGRyZXNzTGFtYmRhKCkpXHJcbiAgICBjb25zdCBHZXRKb2JzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkdldEpvYnNcIiwgR2V0Sm9ic0xhbWJkYSgpKVxyXG4gICAgY29uc3QgR2V0UGF5bWVudERldGFpbHNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsIFwiR2V0UGF5bWVudERldGFpbHNcIiwgR2V0UGF5bWVudERldGFpbHNMYW1iZGEoKSlcclxuICAgIGNvbnN0IENyZWF0ZVBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgXCJDcmVhdGVQYXltZW50SGlzdG9yeURldGFpbHNcIiwgQ3JlYXRlUGF5bWVudEhpc3RvcnlEZXRhaWxzTGFtYmRhKCkpXHJcbiAgICBjb25zdCBHZXRQYXltZW50SGlzdG9yeURldGFpbHNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsIFwiR2V0UGF5bWVudEhpc3RvcnlEZXRhaWxzXCIsIEdldFBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYSgpKVxyXG4gICAgXHJcblxyXG4gICAgY29uc3QgYXBpID0gbmV3IGFwaWdhdGV3YXkuUmVzdEFwaSh0aGlzLCAnV29ya3NNYW5BcGlEZWZhdWx0JywgQXBpZ2F0ZXdheURhdGFDb25zdGFudHMoYXBpZ2F0ZXdheSkpO1xyXG5cclxuICAgIGNvbnN0IHVzZXJQb29sID0gbmV3IGNvZ25pdG8uVXNlclBvb2wodGhpcywgJ3VzZXJwb29sJywge1xyXG4gICAgICB1c2VyUG9vbE5hbWU6IGB2ay1jbGVhbi1wb3J0YWxgLFxyXG4gICAgICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxyXG4gICAgICBzZWxmU2lnblVwRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgc2lnbkluQWxpYXNlczogeyBlbWFpbDogdHJ1ZSwgcGhvbmU6IHRydWUgfSxcclxuICAgICAgYXV0b1ZlcmlmeTogeyBlbWFpbDogdHJ1ZSB9LFxyXG4gICAgICBwYXNzd29yZFBvbGljeToge1xyXG4gICAgICAgIG1pbkxlbmd0aDogNixcclxuICAgICAgICByZXF1aXJlTG93ZXJjYXNlOiB0cnVlLFxyXG4gICAgICAgIHJlcXVpcmVEaWdpdHM6IHRydWUsXHJcbiAgICAgICAgcmVxdWlyZVVwcGVyY2FzZTogdHJ1ZSxcclxuICAgICAgICByZXF1aXJlU3ltYm9sczogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgICAgc3RhbmRhcmRBdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgZ2l2ZW5OYW1lOiB7XHJcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgIG11dGFibGU6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhbWlseU5hbWU6IHtcclxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgbXV0YWJsZTogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW1haWw6IHtcclxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgbXV0YWJsZTogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRkcmVzczoge1xyXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICBtdXRhYmxlOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiaXJ0aGRhdGU6IHtcclxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgbXV0YWJsZTogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2VuZGVyOiB7XHJcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgIG11dGFibGU6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxvY2FsZToge1xyXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICBtdXRhYmxlOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwaG9uZU51bWJlcjoge1xyXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICBtdXRhYmxlOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgYWNjb3VudFJlY292ZXJ5OiBjb2duaXRvLkFjY291bnRSZWNvdmVyeS5FTUFJTF9PTkxZLFxyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIGNvbnN0IHN0YW5kYXJkQ29nbml0b0F0dHJpYnV0ZXMgPSB7XHJcbiAgICAgIGdpdmVuTmFtZTogdHJ1ZSxcclxuICAgICAgZmFtaWx5TmFtZTogdHJ1ZSxcclxuICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgIGFkZHJlc3M6IHRydWUsXHJcbiAgICAgIGJpcnRoZGF0ZTogdHJ1ZSxcclxuICAgICAgZ2VuZGVyOiB0cnVlLFxyXG4gICAgICBsb2NhbGU6IHRydWUsXHJcbiAgICAgIHBob25lTnVtYmVyOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBjbGllbnRSZWFkQXR0cmlidXRlcyA9IG5ldyBjb2duaXRvLkNsaWVudEF0dHJpYnV0ZXMoKVxyXG4gICAgICAud2l0aFN0YW5kYXJkQXR0cmlidXRlcyhzdGFuZGFyZENvZ25pdG9BdHRyaWJ1dGVzKVxyXG5cclxuICAgIGNvbnN0IGNsaWVudFdyaXRlQXR0cmlidXRlcyA9IG5ldyBjb2duaXRvLkNsaWVudEF0dHJpYnV0ZXMoKVxyXG4gICAgICAud2l0aFN0YW5kYXJkQXR0cmlidXRlcyh7XHJcbiAgICAgICAgLi4uc3RhbmRhcmRDb2duaXRvQXR0cmlidXRlcyxcclxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgICBwaG9uZU51bWJlclZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgfSlcclxuXHJcblxyXG5cclxuICAgIGNvbnN0IHVzZXJQb29sQ2xpZW50ID0gbmV3IGNvZ25pdG8uVXNlclBvb2xDbGllbnQodGhpcywgJ3VzZXJwb29sLWNsaWVudCcsIHtcclxuICAgICAgdXNlclBvb2wsXHJcbiAgICAgIGF1dGhGbG93czoge1xyXG4gICAgICAgIGFkbWluVXNlclBhc3N3b3JkOiB0cnVlLFxyXG4gICAgICAgIGN1c3RvbTogdHJ1ZSxcclxuICAgICAgICB1c2VyU3JwOiB0cnVlLFxyXG4gICAgICAgIHVzZXJQYXNzd29yZDogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBzdXBwb3J0ZWRJZGVudGl0eVByb3ZpZGVyczogW1xyXG4gICAgICAgIGNvZ25pdG8uVXNlclBvb2xDbGllbnRJZGVudGl0eVByb3ZpZGVyLkNPR05JVE8sXHJcbiAgICAgIF0sXHJcbiAgICAgIHJlYWRBdHRyaWJ1dGVzOiBjbGllbnRSZWFkQXR0cmlidXRlcyxcclxuICAgICAgd3JpdGVBdHRyaWJ1dGVzOiBjbGllbnRXcml0ZUF0dHJpYnV0ZXMsXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsICdyZWdpb24nLCB7IHZhbHVlOiBjZGsuU3RhY2sub2YodGhpcykucmVnaW9uIH0pO1xyXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ3VzZXJQb29sSWQnLCB7IHZhbHVlOiB1c2VyUG9vbC51c2VyUG9vbElkIH0pO1xyXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ3VzZXJQb29sQ2xpZW50SWQnLCB7XHJcbiAgICAgIHZhbHVlOiB1c2VyUG9vbENsaWVudC51c2VyUG9vbENsaWVudElkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ2FwaVVybCcsIHsgdmFsdWU6IGFwaS51cmwgfSk7XHJcblxyXG5cclxuXHJcbiAgICBjb25zdCBhdXRoID0gbmV3IGFwaWdhdGV3YXkuQ29nbml0b1VzZXJQb29sc0F1dGhvcml6ZXIodGhpcywgJ0F1dGhvcml6ZXInLCB7XHJcbiAgICAgIGNvZ25pdG9Vc2VyUG9vbHM6IFt1c2VyUG9vbF1cclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG4gICAgLy8gUE9TVCBBUElTXHJcbiAgICBXb3Jrc21hblRlcm1zQW5kQ29uZGl0aW9uc0FwaUdhdGV3YXkoYXBpLCBXb3Jrc01hblRlcm1zQW5kQ29uZGl0aW9uLCAnUE9TVCcsIGF1dGgpXHJcbiAgICB3b3Jrc21hbkV4cGVyaWVuY2VBcGlHYXRld2F5KGFwaSwgV29ya3NNYW5FeHBlcmllbmNlLCAnUE9TVCcsIGF1dGgpXHJcbiAgICBQb3N0VXNlckFwaUdhdGV3YXkoYXBpLCBQb3N0VGVzdFVzZXIsICdQT1NUJywgYXV0aClcclxuICAgIFVzZXJQb3N0Q29kZXNBcGlHYXRld2F5KGFwaSwgVXNlclBvc3RDb2RlTGFtYmRhQXBpLCAnUE9TVCcsIGF1dGgpXHJcbiAgICBXb3Jrc21uYVNjaGVkdWxlQXBpR2F0ZXdheShhcGksIFdvcmtzbW5hU2NoZWR1bGVMYW1iZGFBcGksICdQT1NUJywgYXV0aClcclxuICAgIFdvcmtzbWFuam9ic0NyZWF0ZUFwaUdhdGV3YXkoYXBpLCBXb3Jrc21hbmpvYnNDcmVhdGVMYW1iZGFBcGksICdQT1NUJywgYXV0aClcclxuICAgIENyZWF0ZUJhbmtEZXRhaWxzQXBpR2F0ZXdheShhcGksIENyZWF0ZUJhbmtEZXRhaWxzTGFtYmRhQXBpLCAnUE9TVCcsIGF1dGgpXHJcbiAgICBDcmVhdGVNZXNzYWdlc0FwaUdhdGV3YXkoYXBpLCBDcmVhdGVNZXNzYWdlc0xhbWJkYUFwaSwgJ1BPU1QnLCBhdXRoKVxyXG4gICAgQ3JlYXRlQ3VzdG9tZXJUYWJsZUFwaUdhdGV3YXkoYXBpLCBDcmVhdGVDdXN0b21lclRhYmxlTGFtYmRhQXBpLCAnUE9TVCcsIGF1dGgpXHJcbiAgICBDcmVhdGVDdXN0b21lckFkZHJlc3NBcGlHYXRld2F5KGFwaSwgQ3JlYXRlQ3VzdG9tZXJUYWJsZUxhbWJkYUFwaSwgJ1BPU1QnLCBhdXRoKVxyXG4gICAgQ3JlYXRlUGF5bWVudEhpc3RvcnlEZXRhaWxzQXBpR2F0ZXdheShhcGksIENyZWF0ZUN1c3RvbWVyVGFibGVMYW1iZGFBcGksICdQT1NUJywgYXV0aClcclxuXHJcbiAgICAvLyBHRVQgQVBJU1xyXG4gICAgR2V0V29ya3NtYW5BY2NvdW50UmVnaXN0YXJ0aW9uU3RhdHVzQXBpR2F0ZXdheShhcGksIEdldFdvcmtzbWFuQWNjb3VudFJlZ2lzdGFydGlvblN0YXR1cywgJ0dFVCcsIGF1dGgpXHJcbiAgICBHZXRUZXN0VXNlckFwaUdhdGV3YXkoYXBpLCBHZXRUZXN0VXNlciwgJ0dFVCcsIGF1dGgpXHJcbiAgICBnZXRBbGxNb2JpbGVOdW1iZXJzQXBpR2F0ZXdheShhcGksIGdldEFsbE1vYmlsZU51bWJlcnNEZW1vLCAnR0VUJylcclxuICAgIEdldFdvcmttYW5EZXRhaWxzQXBpR2F0ZXdheShhcGksIEdldFdvcmttYW5EZXRhaWxMYW1iZGEsICdHRVQnLCBhdXRoKVxyXG4gICAgR2V0QWxsUG9zdGNvZGVzQXBpR2F0ZXdheShhcGksIEdldEFsbFBvc3Rjb2Rlc0xhbWJkYUFwaSwgJ0dFVCcsIGF1dGgpXHJcbiAgICBHZXRXb3Jrc21hblNjaGVkdWxlQXBpR2F0ZXdheShhcGksIEdldFdvcmtzbWFuU2NoZWR1bGVMYW1iZGFBcGksICdHRVQnLCBhdXRoKVxyXG4gICAgR2V0V29ya3NtYW5qb2JzQXBpR2F0ZXdheShhcGksIEdldFdvcmtzbWFuam9ic0xhbWJkYUFwaSwgJ0dFVCcsIGF1dGgpXHJcbiAgICBHZXRCYW5rRGV0YWlsc0FwaUdhdGV3YXkoYXBpLCBHZXRCYW5rRGV0YWlsc0xhbWJkYUFwaSwgJ0dFVCcsIGF1dGgpXHJcbiAgICBHZXRNZXNzYWdlc0FwaUdhdGV3YXkoYXBpLCBHZXRNZXNzYWdlc0xhbWJkYUFwaSwgJ0dFVCcsIGF1dGgpXHJcbiAgICBHZXRKb2JzQXBpR2F0ZXdheShhcGksIEdldEpvYnNMYW1iZGFBcGksICdHRVQnLCBhdXRoKVxyXG4gICAgR2V0UGF5bWVudERldGFpbHNBcGlHYXRld2F5KGFwaSwgR2V0UGF5bWVudERldGFpbHNMYW1iZGFBcGksICdHRVQnLCBhdXRoKVxyXG4gICAgR2V0UGF5bWVudEhpc3RvcnlEZXRhaWxzQXBpR2F0ZXdheShhcGksIEdldFBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYUFwaSwgJ0dFVCcsIGF1dGgpXHJcblxyXG4gICAgLy8gREVMRVRFIEFQSVNcclxuICAgIERlbGV0ZVBvc3Rjb2Rlc0FwaUdhdGV3YXkoYXBpLCBEZWxldGVQb3N0Y29kZXNMYW1iZGFBcGksICdERUxFVEUnLCBhdXRoKVxyXG4gICAgRGVsZXRlV29ya21hblNjaGVkdWxlQXBpR2F0ZXdheShhcGksIERlbGV0ZVdvcmttYW5TY2hlZHVsZUxhbWJkYUFwaSwgJ0RFTEVURScsIGF1dGgpXHJcblxyXG4gICAgLy8gVVBEQVRFIEFQSVNcclxuICAgIFVwZGF0ZVdvcmtzbWFuRGV0YWlsc0FwaUdhdGV3YXkoYXBpLCBVcGRhdGVXb3Jrc21hbkRldGFpbExhbWJkYSwgJ1BVVCcsIGF1dGgpXHJcblxyXG4gIH1cclxufSJdfQ==