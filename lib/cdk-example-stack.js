"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CdkExampleStack = void 0;
const cdk = require("@aws-cdk/core");
const lambda = require("@aws-cdk/aws-lambda");
const alllambda_1 = require("./resources/lambda/alllambda");
const apigateway = require("@aws-cdk/aws-apigateway");
const ApiGatewayConstant_1 = require("../constants/ApiGatewayConstant");
const AllApiGateWays_1 = require("./resources/ApiGateway/AllApiGateWays");
const cognito = require("@aws-cdk/aws-cognito");
class CdkExampleStack extends cdk.Stack {
    // public readonly urlOutput: CfnOutput;
    constructor(scope, id, props) {
        super(scope, id, props);
        const userRegistration = new lambda.Function(this, "UserRegistration", alllambda_1.UserRegistrationLambda());
        const WorksManTermsAndCondition = new lambda.Function(this, "WorksManTermsAndCondition", alllambda_1.WorksManTermsAndConditionLambda());
        const WorksManExperience = new lambda.Function(this, "WorksManExperience", alllambda_1.WorksManExperienceLambda());
        const GetWorksmanAccountRegistartionStatus = new lambda.Function(this, "GetWorksmanAccountRegistartionStatus", alllambda_1.GetWorksmanAccountRegistartionStatusLambda());
        const getAllMobileNumbersDemo = new lambda.Function(this, "getAllMobileNumber", alllambda_1.getAllMobileNumberLambda());
        const GetWorkmanDetailLambda = new lambda.Function(this, "GetWorkmanDetails", alllambda_1.GetWorkmanDetailsLambda());
        const UpdateWorksmanDetailLambda = new lambda.Function(this, "UpdateWorksmanDetail", alllambda_1.UpdateWorksmanDetailsLambda());
        const UserPostCodeLambdaApi = new lambda.Function(this, "UserPostCodes", alllambda_1.UserPostCodesLambda());
        const GetAllPostcodesLambdaApi = new lambda.Function(this, "GetAllPostcodes", alllambda_1.GetAllPostcodesLambda());
        const DeletePostcodesLambdaApi = new lambda.Function(this, "DeletePostcodes", alllambda_1.DeletePostcodesLambda());
        const CreateWorksmanScheduleLambdaApi = new lambda.Function(this, "CreateWorksmanSchedule", alllambda_1.CreateWorksmanScheduleLambda());
        const DeleteWorkmanScheduleLambdaApi = new lambda.Function(this, "DeleteWorkmanSchedule", alllambda_1.DeleteWorkmanScheduleLambda());
        const GetWorksmanScheduleLambdaApi = new lambda.Function(this, "GetWorksmanSchedule", alllambda_1.GetWorksmanSchedulesLambda());
        const GetWorksmanjobsLambdaApi = new lambda.Function(this, "GetWorksmanjobs", alllambda_1.GetWorksmanjobsLambda());
        const WorksmanjobsCreateLambdaApi = new lambda.Function(this, "WorksmanjobsCreate", alllambda_1.WorksmanjobsCreateLambda());
        const CreateBankDetailsLambdaApi = new lambda.Function(this, "CreateBankDetails", alllambda_1.CreateBankDetailsLambda());
        const GetBankDetailsLambdaApi = new lambda.Function(this, "GetBankDetails", alllambda_1.GetBankDetailsLambda());
        const CreateMessagesLambdaApi = new lambda.Function(this, "CreateMessages", alllambda_1.CreateMessagesLambda());
        const GetMessagesLambdaApi = new lambda.Function(this, "GetMessages", alllambda_1.GetMessagesLambda());
        // const CreateCustomerTableLambdaApi = new lambda.Function(this, "CreateCustomerTable", CreateCustomerTableLambda())
        // const CreateCustomerAddressLambdaApi = new lambda.Function(this, "CreateCustomerAddress", CreateCustomerAddressLambda())
        const GetJobsLambdaApi = new lambda.Function(this, "GetJobs", alllambda_1.GetJobsLambda());
        const GetListOfJobsBasedOnMonthLambdaApi = new lambda.Function(this, "GetListOfJobsBasedOnMonth", alllambda_1.GetListOfJobsBasedOnMonthLambda());
        const GetPaymentDetailsLambdaApi = new lambda.Function(this, "GetPaymentDetails", alllambda_1.GetPaymentDetailsLambda());
        const CreatePaymentHistoryDetailsLambdaApi = new lambda.Function(this, "CreatePaymentHistoryDetails", alllambda_1.CreatePaymentHistoryDetailsLambda());
        const GetPaymentHistoryDetailsLambdaApi = new lambda.Function(this, "GetPaymentHistoryDetails", alllambda_1.GetPaymentHistoryDetailsLambda());
        const GetDistrictWisePostCodesLambdaApi = new lambda.Function(this, "GetDistrictWisePostCodes", alllambda_1.GetDistrictWisePostCodesLambda());
        const UpdateBankDetailsLambdaApi = new lambda.Function(this, "UpdateBankDetails", alllambda_1.UpdateBankDetailsLambda());
        const api = new apigateway.RestApi(this, "WorksmanApiData", ApiGatewayConstant_1.ApigatewayDataConstants(apigateway));
        const userPool = new cognito.UserPool(this, "userpool", {
            userPoolName: `vk-clean-portal`,
            removalPolicy: cdk.RemovalPolicy.DESTROY,
            selfSignUpEnabled: true,
            signInAliases: { email: true, phone: true },
            autoVerify: { email: true },
            passwordPolicy: {
                minLength: 6,
                requireLowercase: true,
                requireDigits: true,
                requireUppercase: true,
                requireSymbols: true,
            },
            standardAttributes: {
                givenName: {
                    required: true,
                    mutable: true,
                },
                familyName: {
                    required: true,
                    mutable: true,
                },
                email: {
                    required: true,
                    mutable: true,
                },
                address: {
                    required: true,
                    mutable: true,
                },
                birthdate: {
                    required: true,
                    mutable: true,
                },
                gender: {
                    required: true,
                    mutable: true,
                },
                locale: {
                    required: true,
                    mutable: true,
                },
                phoneNumber: {
                    required: true,
                    mutable: true,
                },
            },
            accountRecovery: cognito.AccountRecovery.EMAIL_ONLY,
        });
        const standardCognitoAttributes = {
            givenName: true,
            familyName: true,
            email: true,
            address: true,
            birthdate: true,
            gender: true,
            locale: true,
            phoneNumber: true,
        };
        const clientReadAttributes = new cognito.ClientAttributes().withStandardAttributes(standardCognitoAttributes);
        const clientWriteAttributes = new cognito.ClientAttributes().withStandardAttributes({
            ...standardCognitoAttributes,
            emailVerified: false,
            phoneNumberVerified: false,
        });
        const userPoolClient = new cognito.UserPoolClient(this, "userpool-client", {
            userPool,
            authFlows: {
                adminUserPassword: true,
                custom: true,
                userSrp: true,
                userPassword: true,
            },
            supportedIdentityProviders: [
                cognito.UserPoolClientIdentityProvider.COGNITO,
            ],
            readAttributes: clientReadAttributes,
            writeAttributes: clientWriteAttributes,
        });
        new cdk.CfnOutput(this, "region", { value: cdk.Stack.of(this).region });
        new cdk.CfnOutput(this, "userPoolId", { value: userPool.userPoolId });
        new cdk.CfnOutput(this, "userPoolClientId", {
            value: userPoolClient.userPoolClientId,
        });
        new cdk.CfnOutput(this, "apiUrl", { value: api.url });
        const auth = new apigateway.CognitoUserPoolsAuthorizer(this, "Authorizer", {
            cognitoUserPools: [userPool],
        });
        // POST APIS
        AllApiGateWays_1.WorksmanTermsAndConditionsApiGateway(api, WorksManTermsAndCondition, "POST", auth);
        AllApiGateWays_1.worksmanExperienceApiGateway(api, WorksManExperience, "POST", auth);
        // PostUserApiGateway(api, PostTestUser, 'POST', auth)
        AllApiGateWays_1.createPostcodesApiGateway(api, UserPostCodeLambdaApi, "POST", auth);
        AllApiGateWays_1.CreateWorksmanScheduleApiGateway(api, CreateWorksmanScheduleLambdaApi, "POST", auth);
        AllApiGateWays_1.CreateJobsApiGateway(api, WorksmanjobsCreateLambdaApi, "POST", auth);
        AllApiGateWays_1.CreateBankDetailsApiGateway(api, CreateBankDetailsLambdaApi, "POST", auth);
        AllApiGateWays_1.CreateMessagesApiGateway(api, CreateMessagesLambdaApi, "POST", auth);
        // CreateCustomerTableApiGateway(api, CreateCustomerTableLambdaApi, 'POST', auth)
        // CreateCustomerAddressApiGateway(api, CreateCustomerTableLambdaApi, 'POST', auth)
        // // CreatePaymentHistoryDetailsApiGateway(api, CreateCustomerTableLambdaApi, 'POST', auth)
        // // GET APIS
        AllApiGateWays_1.GetWorksmanAccountRegistartionStatusApiGateway(api, GetWorksmanAccountRegistartionStatus, "GET", auth);
        // GetTestUserApiGateway(api, GetTestUser, 'GET', auth)
        AllApiGateWays_1.getAllMobileNumbersApiGateway(api, getAllMobileNumbersDemo, "GET");
        AllApiGateWays_1.GetWorkmanDetailsApiGateway(api, GetWorkmanDetailLambda, "GET", auth);
        AllApiGateWays_1.GetAllPostcodesApiGateway(api, GetAllPostcodesLambdaApi, "GET", auth);
        AllApiGateWays_1.GetWorksmanScheduleApiGateway(api, GetWorksmanScheduleLambdaApi, "GET", auth);
        AllApiGateWays_1.GetWorksmanjobsApiGateway(api, GetWorksmanjobsLambdaApi, "GET", auth);
        AllApiGateWays_1.GetBankDetailsApiGateway(api, GetBankDetailsLambdaApi, "GET", auth);
        AllApiGateWays_1.GetMessagesApiGateway(api, GetMessagesLambdaApi, "GET", auth);
        AllApiGateWays_1.GetJobsApiGateway(api, GetJobsLambdaApi, "GET", auth);
        AllApiGateWays_1.GetListOfJobsBasedOnMonthApiGateway(api, GetListOfJobsBasedOnMonthLambdaApi, "GET", auth);
        AllApiGateWays_1.GetPaymentDetailsApiGateway(api, GetPaymentDetailsLambdaApi, "GET", auth);
        AllApiGateWays_1.GetPaymentHistoryDetailsApiGateway(api, GetPaymentHistoryDetailsLambdaApi, "GET", auth);
        AllApiGateWays_1.GetDistrictWisePostCodesApiGateway(api, GetDistrictWisePostCodesLambdaApi, "GET", auth);
        // // DELETE APIS
        AllApiGateWays_1.DeletePostcodesApiGateway(api, DeletePostcodesLambdaApi, "DELETE", auth);
        AllApiGateWays_1.DeleteWorkmanScheduleApiGateway(api, DeleteWorkmanScheduleLambdaApi, "DELETE", auth);
        // // UPDATE APIS
        AllApiGateWays_1.UpdateWorksmanDetailsApiGateway(api, UpdateWorksmanDetailLambda, "PUT", auth);
        AllApiGateWays_1.UpdateBankDetailsApiGateway(api, UpdateBankDetailsLambdaApi, "PUT", auth);
    }
}
exports.CdkExampleStack = CdkExampleStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrLWV4YW1wbGUtc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjZGstZXhhbXBsZS1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxxQ0FBcUM7QUFDckMsOENBQThDO0FBQzlDLDREQTJCc0M7QUFFdEMsc0RBQXNEO0FBQ3RELHdFQUEwRTtBQUMxRSwwRUF5QitDO0FBQy9DLGdEQUFnRDtBQUVoRCxNQUFhLGVBQWdCLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFFNUMsd0NBQXdDO0lBQ3hDLFlBQVksS0FBb0IsRUFBRSxFQUFVLEVBQUUsS0FBc0I7UUFDbEUsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFFeEIsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQzFDLElBQUksRUFDSixrQkFBa0IsRUFDbEIsa0NBQXNCLEVBQUUsQ0FDekIsQ0FBQztRQUNGLE1BQU0seUJBQXlCLEdBQUcsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUNuRCxJQUFJLEVBQ0osMkJBQTJCLEVBQzNCLDJDQUErQixFQUFFLENBQ2xDLENBQUM7UUFDRixNQUFNLGtCQUFrQixHQUFHLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FDNUMsSUFBSSxFQUNKLG9CQUFvQixFQUNwQixvQ0FBd0IsRUFBRSxDQUMzQixDQUFDO1FBQ0YsTUFBTSxvQ0FBb0MsR0FBRyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQzlELElBQUksRUFDSixzQ0FBc0MsRUFDdEMsc0RBQTBDLEVBQUUsQ0FDN0MsQ0FBQztRQUNGLE1BQU0sdUJBQXVCLEdBQUcsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUNqRCxJQUFJLEVBQ0osb0JBQW9CLEVBQ3BCLG9DQUF3QixFQUFFLENBQzNCLENBQUM7UUFDRixNQUFNLHNCQUFzQixHQUFHLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FDaEQsSUFBSSxFQUNKLG1CQUFtQixFQUNuQixtQ0FBdUIs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R0FBRyxFQUNILGtDQUFrQyxFQUNsQyxLQUFLLEVBQ0wsSUFBSSxDQUNMLENBQUM7UUFDRiw0Q0FBMkIsQ0FBQyxHQUFHLEVBQUUsMEJBQTBCLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzFFLG1EQUFrQyxDQUNoQyxHQUFHLEVBQ0gsaUNBQWlDLEVBQ2pDLEtBQUssRUFDTCxJQUFJLENBQ0wsQ0FBQztRQUNGLG1EQUFrQyxDQUNoQyxHQUFHLEVBQ0gsaUNBQWlDLEVBQ2pDLEtBQUssRUFDTCxJQUFJLENBQ0wsQ0FBQztRQUVGLGlCQUFpQjtRQUNqQiwwQ0FBeUIsQ0FBQyxHQUFHLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3pFLGdEQUErQixDQUM3QixHQUFHLEVBQ0gsOEJBQThCLEVBQzlCLFFBQVEsRUFDUixJQUFJLENBQ0wsQ0FBQztRQUVGLGlCQUFpQjtRQUNqQixnREFBK0IsQ0FDN0IsR0FBRyxFQUNILDBCQUEwQixFQUMxQixLQUFLLEVBQ0wsSUFBSSxDQUNMLENBQUM7UUFDRiw0Q0FBMkIsQ0FBQyxHQUFHLEVBQUUsMEJBQTBCLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzVFLENBQUM7Q0FDRjtBQXZVRCwwQ0F1VUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjZGsgZnJvbSBcIkBhd3MtY2RrL2NvcmVcIjtcclxuaW1wb3J0ICogYXMgbGFtYmRhIGZyb20gXCJAYXdzLWNkay9hd3MtbGFtYmRhXCI7XHJcbmltcG9ydCB7XHJcbiAgVXNlclJlZ2lzdHJhdGlvbkxhbWJkYSxcclxuICBXb3Jrc01hblRlcm1zQW5kQ29uZGl0aW9uTGFtYmRhLFxyXG4gIFdvcmtzTWFuRXhwZXJpZW5jZUxhbWJkYSxcclxuICBHZXRXb3Jrc21hbkFjY291bnRSZWdpc3RhcnRpb25TdGF0dXNMYW1iZGEsXHJcbiAgZ2V0QWxsTW9iaWxlTnVtYmVyTGFtYmRhLFxyXG4gIEdldFdvcmttYW5EZXRhaWxzTGFtYmRhLFxyXG4gIFVwZGF0ZVdvcmtzbWFuRGV0YWlsc0xhbWJkYSxcclxuICBVc2VyUG9zdENvZGVzTGFtYmRhLFxyXG4gIEdldEFsbFBvc3Rjb2Rlc0xhbWJkYSxcclxuICBEZWxldGVQb3N0Y29kZXNMYW1iZGEsXHJcbiAgQ3JlYXRlV29ya3NtYW5TY2hlZHVsZUxhbWJkYSxcclxuICBEZWxldGVXb3JrbWFuU2NoZWR1bGVMYW1iZGEsXHJcbiAgR2V0V29ya3NtYW5TY2hlZHVsZXNMYW1iZGEsXHJcbiAgR2V0V29ya3NtYW5qb2JzTGFtYmRhLFxyXG4gIFdvcmtzbWFuam9ic0NyZWF0ZUxhbWJkYSxcclxuICBHZXRNZXNzYWdlc0xhbWJkYSxcclxuICBDcmVhdGVNZXNzYWdlc0xhbWJkYSxcclxuICBDcmVhdGVCYW5rRGV0YWlsc0xhbWJkYSxcclxuICBHZXRCYW5rRGV0YWlsc0xhbWJkYSxcclxuICBHZXRKb2JzTGFtYmRhLFxyXG4gIEdldFBheW1lbnREZXRhaWxzTGFtYmRhLFxyXG4gIENyZWF0ZVBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYSxcclxuICBHZXRQYXltZW50SGlzdG9yeURldGFpbHNMYW1iZGEsXHJcbiAgR2V0RGlzdHJpY3RXaXNlUG9zdENvZGVzTGFtYmRhLFxyXG4gIFVwZGF0ZUJhbmtEZXRhaWxzTGFtYmRhLFxyXG4gIEdldExpc3RPZkpvYnNCYXNlZE9uTW9udGhMYW1iZGEsXHJcbn0gZnJvbSBcIi4vcmVzb3VyY2VzL2xhbWJkYS9hbGxsYW1iZGFcIjtcclxuaW1wb3J0ICogYXMgc2ZuIGZyb20gXCJAYXdzLWNkay9hd3Mtc3RlcGZ1bmN0aW9uc1wiO1xyXG5pbXBvcnQgKiBhcyBhcGlnYXRld2F5IGZyb20gXCJAYXdzLWNkay9hd3MtYXBpZ2F0ZXdheVwiO1xyXG5pbXBvcnQgeyBBcGlnYXRld2F5RGF0YUNvbnN0YW50cyB9IGZyb20gXCIuLi9jb25zdGFudHMvQXBpR2F0ZXdheUNvbnN0YW50XCI7XHJcbmltcG9ydCB7XHJcbiAgV29ya3NtYW5UZXJtc0FuZENvbmRpdGlvbnNBcGlHYXRld2F5LFxyXG4gIGdldEFsbE1vYmlsZU51bWJlcnNBcGlHYXRld2F5LFxyXG4gIHdvcmtzbWFuRXhwZXJpZW5jZUFwaUdhdGV3YXksXHJcbiAgR2V0V29ya3NtYW5BY2NvdW50UmVnaXN0YXJ0aW9uU3RhdHVzQXBpR2F0ZXdheSxcclxuICBHZXRXb3JrbWFuRGV0YWlsc0FwaUdhdGV3YXksXHJcbiAgVXBkYXRlV29ya3NtYW5EZXRhaWxzQXBpR2F0ZXdheSxcclxuICBjcmVhdGVQb3N0Y29kZXNBcGlHYXRld2F5LFxyXG4gIEdldEFsbFBvc3Rjb2Rlc0FwaUdhdGV3YXksXHJcbiAgRGVsZXRlUG9zdGNvZGVzQXBpR2F0ZXdheSxcclxuICBDcmVhdGVXb3Jrc21hblNjaGVkdWxlQXBpR2F0ZXdheSxcclxuICBEZWxldGVXb3JrbWFuU2NoZWR1bGVBcGlHYXRld2F5LFxyXG4gIEdldFdvcmtzbWFuU2NoZWR1bGVBcGlHYXRld2F5LFxyXG4gIEdldFdvcmtzbWFuam9ic0FwaUdhdGV3YXksXHJcbiAgQ3JlYXRlSm9ic0FwaUdhdGV3YXksXHJcbiAgR2V0TWVzc2FnZXNBcGlHYXRld2F5LFxyXG4gIENyZWF0ZU1lc3NhZ2VzQXBpR2F0ZXdheSxcclxuICBDcmVhdGVCYW5rRGV0YWlsc0FwaUdhdGV3YXksXHJcbiAgR2V0QmFua0RldGFpbHNBcGlHYXRld2F5LFxyXG4gIEdldEpvYnNBcGlHYXRld2F5LFxyXG4gIEdldFBheW1lbnREZXRhaWxzQXBpR2F0ZXdheSxcclxuICBHZXRQYXltZW50SGlzdG9yeURldGFpbHNBcGlHYXRld2F5LFxyXG4gIEdldERpc3RyaWN0V2lzZVBvc3RDb2Rlc0FwaUdhdGV3YXksXHJcbiAgVXBkYXRlQmFua0RldGFpbHNBcGlHYXRld2F5LFxyXG4gIEdldExpc3RPZkpvYnNCYXNlZE9uTW9udGhBcGlHYXRld2F5LFxyXG59IGZyb20gXCIuL3Jlc291cmNlcy9BcGlHYXRld2F5L0FsbEFwaUdhdGVXYXlzXCI7XHJcbmltcG9ydCAqIGFzIGNvZ25pdG8gZnJvbSBcIkBhd3MtY2RrL2F3cy1jb2duaXRvXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2RrRXhhbXBsZVN0YWNrIGV4dGVuZHMgY2RrLlN0YWNrIHtcclxuICBwdWJsaWMgTWFjaGluZTogc2ZuLlN0YXRlTWFjaGluZTtcclxuICAvLyBwdWJsaWMgcmVhZG9ubHkgdXJsT3V0cHV0OiBDZm5PdXRwdXQ7XHJcbiAgY29uc3RydWN0b3Ioc2NvcGU6IGNkay5Db25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzPzogY2RrLlN0YWNrUHJvcHMpIHtcclxuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xyXG5cclxuICAgIGNvbnN0IHVzZXJSZWdpc3RyYXRpb24gPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIlVzZXJSZWdpc3RyYXRpb25cIixcclxuICAgICAgVXNlclJlZ2lzdHJhdGlvbkxhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgV29ya3NNYW5UZXJtc0FuZENvbmRpdGlvbiA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiV29ya3NNYW5UZXJtc0FuZENvbmRpdGlvblwiLFxyXG4gICAgICBXb3Jrc01hblRlcm1zQW5kQ29uZGl0aW9uTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBXb3Jrc01hbkV4cGVyaWVuY2UgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIldvcmtzTWFuRXhwZXJpZW5jZVwiLFxyXG4gICAgICBXb3Jrc01hbkV4cGVyaWVuY2VMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IEdldFdvcmtzbWFuQWNjb3VudFJlZ2lzdGFydGlvblN0YXR1cyA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiR2V0V29ya3NtYW5BY2NvdW50UmVnaXN0YXJ0aW9uU3RhdHVzXCIsXHJcbiAgICAgIEdldFdvcmtzbWFuQWNjb3VudFJlZ2lzdGFydGlvblN0YXR1c0xhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgZ2V0QWxsTW9iaWxlTnVtYmVyc0RlbW8gPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcImdldEFsbE1vYmlsZU51bWJlclwiLFxyXG4gICAgICBnZXRBbGxNb2JpbGVOdW1iZXJMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IEdldFdvcmttYW5EZXRhaWxMYW1iZGEgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkdldFdvcmttYW5EZXRhaWxzXCIsXHJcbiAgICAgIEdldFdvcmttYW5EZXRhaWxzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBVcGRhdGVXb3Jrc21hbkRldGFpbExhbWJkYSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiVXBkYXRlV29ya3NtYW5EZXRhaWxcIixcclxuICAgICAgVXBkYXRlV29ya3NtYW5EZXRhaWxzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBVc2VyUG9zdENvZGVMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIlVzZXJQb3N0Q29kZXNcIixcclxuICAgICAgVXNlclBvc3RDb2Rlc0xhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgR2V0QWxsUG9zdGNvZGVzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbihcclxuICAgICAgdGhpcyxcclxuICAgICAgXCJHZXRBbGxQb3N0Y29kZXNcIixcclxuICAgICAgR2V0QWxsUG9zdGNvZGVzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBEZWxldGVQb3N0Y29kZXNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkRlbGV0ZVBvc3Rjb2Rlc1wiLFxyXG4gICAgICBEZWxldGVQb3N0Y29kZXNMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IENyZWF0ZVdvcmtzbWFuU2NoZWR1bGVMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkNyZWF0ZVdvcmtzbWFuU2NoZWR1bGVcIixcclxuICAgICAgQ3JlYXRlV29ya3NtYW5TY2hlZHVsZUxhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgRGVsZXRlV29ya21hblNjaGVkdWxlTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbihcclxuICAgICAgdGhpcyxcclxuICAgICAgXCJEZWxldGVXb3JrbWFuU2NoZWR1bGVcIixcclxuICAgICAgRGVsZXRlV29ya21hblNjaGVkdWxlTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBHZXRXb3Jrc21hblNjaGVkdWxlTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbihcclxuICAgICAgdGhpcyxcclxuICAgICAgXCJHZXRXb3Jrc21hblNjaGVkdWxlXCIsXHJcbiAgICAgIEdldFdvcmtzbWFuU2NoZWR1bGVzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBHZXRXb3Jrc21hbmpvYnNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkdldFdvcmtzbWFuam9ic1wiLFxyXG4gICAgICBHZXRXb3Jrc21hbmpvYnNMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IFdvcmtzbWFuam9ic0NyZWF0ZUxhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiV29ya3NtYW5qb2JzQ3JlYXRlXCIsXHJcbiAgICAgIFdvcmtzbWFuam9ic0NyZWF0ZUxhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgQ3JlYXRlQmFua0RldGFpbHNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkNyZWF0ZUJhbmtEZXRhaWxzXCIsXHJcbiAgICAgIENyZWF0ZUJhbmtEZXRhaWxzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBHZXRCYW5rRGV0YWlsc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiR2V0QmFua0RldGFpbHNcIixcclxuICAgICAgR2V0QmFua0RldGFpbHNMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IENyZWF0ZU1lc3NhZ2VzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbihcclxuICAgICAgdGhpcyxcclxuICAgICAgXCJDcmVhdGVNZXNzYWdlc1wiLFxyXG4gICAgICBDcmVhdGVNZXNzYWdlc0xhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgR2V0TWVzc2FnZXNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkdldE1lc3NhZ2VzXCIsXHJcbiAgICAgIEdldE1lc3NhZ2VzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICAvLyBjb25zdCBDcmVhdGVDdXN0b21lclRhYmxlTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkNyZWF0ZUN1c3RvbWVyVGFibGVcIiwgQ3JlYXRlQ3VzdG9tZXJUYWJsZUxhbWJkYSgpKVxyXG4gICAgLy8gY29uc3QgQ3JlYXRlQ3VzdG9tZXJBZGRyZXNzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCBcIkNyZWF0ZUN1c3RvbWVyQWRkcmVzc1wiLCBDcmVhdGVDdXN0b21lckFkZHJlc3NMYW1iZGEoKSlcclxuICAgIGNvbnN0IEdldEpvYnNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkdldEpvYnNcIixcclxuICAgICAgR2V0Sm9ic0xhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgR2V0TGlzdE9mSm9ic0Jhc2VkT25Nb250aExhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiR2V0TGlzdE9mSm9ic0Jhc2VkT25Nb250aFwiLFxyXG4gICAgICBHZXRMaXN0T2ZKb2JzQmFzZWRPbk1vbnRoTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBHZXRQYXltZW50RGV0YWlsc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiR2V0UGF5bWVudERldGFpbHNcIixcclxuICAgICAgR2V0UGF5bWVudERldGFpbHNMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IENyZWF0ZVBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYUFwaSA9IG5ldyBsYW1iZGEuRnVuY3Rpb24oXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiQ3JlYXRlUGF5bWVudEhpc3RvcnlEZXRhaWxzXCIsXHJcbiAgICAgIENyZWF0ZVBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYSgpXHJcbiAgICApO1xyXG4gICAgY29uc3QgR2V0UGF5bWVudEhpc3RvcnlEZXRhaWxzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbihcclxuICAgICAgdGhpcyxcclxuICAgICAgXCJHZXRQYXltZW50SGlzdG9yeURldGFpbHNcIixcclxuICAgICAgR2V0UGF5bWVudEhpc3RvcnlEZXRhaWxzTGFtYmRhKClcclxuICAgICk7XHJcbiAgICBjb25zdCBHZXREaXN0cmljdFdpc2VQb3N0Q29kZXNMYW1iZGFBcGkgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKFxyXG4gICAgICB0aGlzLFxyXG4gICAgICBcIkdldERpc3RyaWN0V2lzZVBvc3RDb2Rlc1wiLFxyXG4gICAgICBHZXREaXN0cmljdFdpc2VQb3N0Q29kZXNMYW1iZGEoKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IFVwZGF0ZUJhbmtEZXRhaWxzTGFtYmRhQXBpID0gbmV3IGxhbWJkYS5GdW5jdGlvbihcclxuICAgICAgdGhpcyxcclxuICAgICAgXCJVcGRhdGVCYW5rRGV0YWlsc1wiLFxyXG4gICAgICBVcGRhdGVCYW5rRGV0YWlsc0xhbWJkYSgpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IGFwaSA9IG5ldyBhcGlnYXRld2F5LlJlc3RBcGkoXHJcbiAgICAgIHRoaXMsXHJcbiAgICAgIFwiV29ya3NtYW5BcGlEYXRhXCIsXHJcbiAgICAgIEFwaWdhdGV3YXlEYXRhQ29uc3RhbnRzKGFwaWdhdGV3YXkpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHVzZXJQb29sID0gbmV3IGNvZ25pdG8uVXNlclBvb2wodGhpcywgXCJ1c2VycG9vbFwiLCB7XHJcbiAgICAgIHVzZXJQb29sTmFtZTogYHZrLWNsZWFuLXBvcnRhbGAsXHJcbiAgICAgIHJlbW92YWxQb2xpY3k6IGNkay5SZW1vdmFsUG9saWN5LkRFU1RST1ksXHJcbiAgICAgIHNlbGZTaWduVXBFbmFibGVkOiB0cnVlLFxyXG4gICAgICBzaWduSW5BbGlhc2VzOiB7IGVtYWlsOiB0cnVlLCBwaG9uZTogdHJ1ZSB9LFxyXG4gICAgICBhdXRvVmVyaWZ5OiB7IGVtYWlsOiB0cnVlIH0sXHJcbiAgICAgIHBhc3N3b3JkUG9saWN5OiB7XHJcbiAgICAgICAgbWluTGVuZ3RoOiA2LFxyXG4gICAgICAgIHJlcXVpcmVMb3dlcmNhc2U6IHRydWUsXHJcbiAgICAgICAgcmVxdWlyZURpZ2l0czogdHJ1ZSxcclxuICAgICAgICByZXF1aXJlVXBwZXJjYXNlOiB0cnVlLFxyXG4gICAgICAgIHJlcXVpcmVTeW1ib2xzOiB0cnVlLFxyXG4gICAgICB9LFxyXG4gICAgICBzdGFuZGFyZEF0dHJpYnV0ZXM6IHtcclxuICAgICAgICBnaXZlbk5hbWU6IHtcclxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgbXV0YWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhbWlseU5hbWU6IHtcclxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgbXV0YWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVtYWlsOiB7XHJcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgIG11dGFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGRyZXNzOiB7XHJcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgIG11dGFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiaXJ0aGRhdGU6IHtcclxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgbXV0YWJsZTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdlbmRlcjoge1xyXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICBtdXRhYmxlOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG9jYWxlOiB7XHJcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgIG11dGFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwaG9uZU51bWJlcjoge1xyXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICBtdXRhYmxlOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGFjY291bnRSZWNvdmVyeTogY29nbml0by5BY2NvdW50UmVjb3ZlcnkuRU1BSUxfT05MWSxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHN0YW5kYXJkQ29nbml0b0F0dHJpYnV0ZXMgPSB7XHJcbiAgICAgIGdpdmVuTmFtZTogdHJ1ZSxcclxuICAgICAgZmFtaWx5TmFtZTogdHJ1ZSxcclxuICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgIGFkZHJlc3M6IHRydWUsXHJcbiAgICAgIGJpcnRoZGF0ZTogdHJ1ZSxcclxuICAgICAgZ2VuZGVyOiB0cnVlLFxyXG4gICAgICBsb2NhbGU6IHRydWUsXHJcbiAgICAgIHBob25lTnVtYmVyOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBjbGllbnRSZWFkQXR0cmlidXRlcyA9XHJcbiAgICAgIG5ldyBjb2duaXRvLkNsaWVudEF0dHJpYnV0ZXMoKS53aXRoU3RhbmRhcmRBdHRyaWJ1dGVzKFxyXG4gICAgICAgIHN0YW5kYXJkQ29nbml0b0F0dHJpYnV0ZXNcclxuICAgICAgKTtcclxuXHJcbiAgICBjb25zdCBjbGllbnRXcml0ZUF0dHJpYnV0ZXMgPVxyXG4gICAgICBuZXcgY29nbml0by5DbGllbnRBdHRyaWJ1dGVzKCkud2l0aFN0YW5kYXJkQXR0cmlidXRlcyh7XHJcbiAgICAgICAgLi4uc3RhbmRhcmRDb2duaXRvQXR0cmlidXRlcyxcclxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgICBwaG9uZU51bWJlclZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgY29uc3QgdXNlclBvb2xDbGllbnQgPSBuZXcgY29nbml0by5Vc2VyUG9vbENsaWVudCh0aGlzLCBcInVzZXJwb29sLWNsaWVudFwiLCB7XHJcbiAgICAgIHVzZXJQb29sLFxyXG4gICAgICBhdXRoRmxvd3M6IHtcclxuICAgICAgICBhZG1pblVzZXJQYXNzd29yZDogdHJ1ZSxcclxuICAgICAgICBjdXN0b206IHRydWUsXHJcbiAgICAgICAgdXNlclNycDogdHJ1ZSxcclxuICAgICAgICB1c2VyUGFzc3dvcmQ6IHRydWUsXHJcbiAgICAgIH0sXHJcbiAgICAgIHN1cHBvcnRlZElkZW50aXR5UHJvdmlkZXJzOiBbXHJcbiAgICAgICAgY29nbml0by5Vc2VyUG9vbENsaWVudElkZW50aXR5UHJvdmlkZXIuQ09HTklUTyxcclxuICAgICAgXSxcclxuICAgICAgcmVhZEF0dHJpYnV0ZXM6IGNsaWVudFJlYWRBdHRyaWJ1dGVzLFxyXG4gICAgICB3cml0ZUF0dHJpYnV0ZXM6IGNsaWVudFdyaXRlQXR0cmlidXRlcyxcclxuICAgIH0pO1xyXG5cclxuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsIFwicmVnaW9uXCIsIHsgdmFsdWU6IGNkay5TdGFjay5vZih0aGlzKS5yZWdpb24gfSk7XHJcbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCBcInVzZXJQb29sSWRcIiwgeyB2YWx1ZTogdXNlclBvb2wudXNlclBvb2xJZCB9KTtcclxuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsIFwidXNlclBvb2xDbGllbnRJZFwiLCB7XHJcbiAgICAgIHZhbHVlOiB1c2VyUG9vbENsaWVudC51c2VyUG9vbENsaWVudElkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgXCJhcGlVcmxcIiwgeyB2YWx1ZTogYXBpLnVybCB9KTtcclxuXHJcbiAgICBjb25zdCBhdXRoID0gbmV3IGFwaWdhdGV3YXkuQ29nbml0b1VzZXJQb29sc0F1dGhvcml6ZXIodGhpcywgXCJBdXRob3JpemVyXCIsIHtcclxuICAgICAgY29nbml0b1VzZXJQb29sczogW3VzZXJQb29sXSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFBPU1QgQVBJU1xyXG4gICAgV29ya3NtYW5UZXJtc0FuZENvbmRpdGlvbnNBcGlHYXRld2F5KFxyXG4gICAgICBhcGksXHJcbiAgICAgIFdvcmtzTWFuVGVybXNBbmRDb25kaXRpb24sXHJcbiAgICAgIFwiUE9TVFwiLFxyXG4gICAgICBhdXRoXHJcbiAgICApO1xyXG4gICAgd29ya3NtYW5FeHBlcmllbmNlQXBpR2F0ZXdheShhcGksIFdvcmtzTWFuRXhwZXJpZW5jZSwgXCJQT1NUXCIsIGF1dGgpO1xyXG4gICAgLy8gUG9zdFVzZXJBcGlHYXRld2F5KGFwaSwgUG9zdFRlc3RVc2VyLCAnUE9TVCcsIGF1dGgpXHJcbiAgICBjcmVhdGVQb3N0Y29kZXNBcGlHYXRld2F5KGFwaSwgVXNlclBvc3RDb2RlTGFtYmRhQXBpLCBcIlBPU1RcIiwgYXV0aCk7XHJcbiAgICBDcmVhdGVXb3Jrc21hblNjaGVkdWxlQXBpR2F0ZXdheShcclxuICAgICAgYXBpLFxyXG4gICAgICBDcmVhdGVXb3Jrc21hblNjaGVkdWxlTGFtYmRhQXBpLFxyXG4gICAgICBcIlBPU1RcIixcclxuICAgICAgYXV0aFxyXG4gICAgKTtcclxuICAgIENyZWF0ZUpvYnNBcGlHYXRld2F5KGFwaSwgV29ya3NtYW5qb2JzQ3JlYXRlTGFtYmRhQXBpLCBcIlBPU1RcIiwgYXV0aCk7XHJcbiAgICBDcmVhdGVCYW5rRGV0YWlsc0FwaUdhdGV3YXkoYXBpLCBDcmVhdGVCYW5rRGV0YWlsc0xhbWJkYUFwaSwgXCJQT1NUXCIsIGF1dGgpO1xyXG4gICAgQ3JlYXRlTWVzc2FnZXNBcGlHYXRld2F5KGFwaSwgQ3JlYXRlTWVzc2FnZXNMYW1iZGFBcGksIFwiUE9TVFwiLCBhdXRoKTtcclxuICAgIC8vIENyZWF0ZUN1c3RvbWVyVGFibGVBcGlHYXRld2F5KGFwaSwgQ3JlYXRlQ3VzdG9tZXJUYWJsZUxhbWJkYUFwaSwgJ1BPU1QnLCBhdXRoKVxyXG4gICAgLy8gQ3JlYXRlQ3VzdG9tZXJBZGRyZXNzQXBpR2F0ZXdheShhcGksIENyZWF0ZUN1c3RvbWVyVGFibGVMYW1iZGFBcGksICdQT1NUJywgYXV0aClcclxuICAgIC8vIC8vIENyZWF0ZVBheW1lbnRIaXN0b3J5RGV0YWlsc0FwaUdhdGV3YXkoYXBpLCBDcmVhdGVDdXN0b21lclRhYmxlTGFtYmRhQXBpLCAnUE9TVCcsIGF1dGgpXHJcblxyXG4gICAgLy8gLy8gR0VUIEFQSVNcclxuICAgIEdldFdvcmtzbWFuQWNjb3VudFJlZ2lzdGFydGlvblN0YXR1c0FwaUdhdGV3YXkoXHJcbiAgICAgIGFwaSxcclxuICAgICAgR2V0V29ya3NtYW5BY2NvdW50UmVnaXN0YXJ0aW9uU3RhdHVzLFxyXG4gICAgICBcIkdFVFwiLFxyXG4gICAgICBhdXRoXHJcbiAgICApO1xyXG4gICAgLy8gR2V0VGVzdFVzZXJBcGlHYXRld2F5KGFwaSwgR2V0VGVzdFVzZXIsICdHRVQnLCBhdXRoKVxyXG4gICAgZ2V0QWxsTW9iaWxlTnVtYmVyc0FwaUdhdGV3YXkoYXBpLCBnZXRBbGxNb2JpbGVOdW1iZXJzRGVtbywgXCJHRVRcIik7XHJcbiAgICBHZXRXb3JrbWFuRGV0YWlsc0FwaUdhdGV3YXkoYXBpLCBHZXRXb3JrbWFuRGV0YWlsTGFtYmRhLCBcIkdFVFwiLCBhdXRoKTtcclxuICAgIEdldEFsbFBvc3Rjb2Rlc0FwaUdhdGV3YXkoYXBpLCBHZXRBbGxQb3N0Y29kZXNMYW1iZGFBcGksIFwiR0VUXCIsIGF1dGgpO1xyXG4gICAgR2V0V29ya3NtYW5TY2hlZHVsZUFwaUdhdGV3YXkoXHJcbiAgICAgIGFwaSxcclxuICAgICAgR2V0V29ya3NtYW5TY2hlZHVsZUxhbWJkYUFwaSxcclxuICAgICAgXCJHRVRcIixcclxuICAgICAgYXV0aFxyXG4gICAgKTtcclxuICAgIEdldFdvcmtzbWFuam9ic0FwaUdhdGV3YXkoYXBpLCBHZXRXb3Jrc21hbmpvYnNMYW1iZGFBcGksIFwiR0VUXCIsIGF1dGgpO1xyXG4gICAgR2V0QmFua0RldGFpbHNBcGlHYXRld2F5KGFwaSwgR2V0QmFua0RldGFpbHNMYW1iZGFBcGksIFwiR0VUXCIsIGF1dGgpO1xyXG4gICAgR2V0TWVzc2FnZXNBcGlHYXRld2F5KGFwaSwgR2V0TWVzc2FnZXNMYW1iZGFBcGksIFwiR0VUXCIsIGF1dGgpO1xyXG4gICAgR2V0Sm9ic0FwaUdhdGV3YXkoYXBpLCBHZXRKb2JzTGFtYmRhQXBpLCBcIkdFVFwiLCBhdXRoKTtcclxuICAgIEdldExpc3RPZkpvYnNCYXNlZE9uTW9udGhBcGlHYXRld2F5KFxyXG4gICAgICBhcGksXHJcbiAgICAgIEdldExpc3RPZkpvYnNCYXNlZE9uTW9udGhMYW1iZGFBcGksXHJcbiAgICAgIFwiR0VUXCIsXHJcbiAgICAgIGF1dGhcclxuICAgICk7XHJcbiAgICBHZXRQYXltZW50RGV0YWlsc0FwaUdhdGV3YXkoYXBpLCBHZXRQYXltZW50RGV0YWlsc0xhbWJkYUFwaSwgXCJHRVRcIiwgYXV0aCk7XHJcbiAgICBHZXRQYXltZW50SGlzdG9yeURldGFpbHNBcGlHYXRld2F5KFxyXG4gICAgICBhcGksXHJcbiAgICAgIEdldFBheW1lbnRIaXN0b3J5RGV0YWlsc0xhbWJkYUFwaSxcclxuICAgICAgXCJHRVRcIixcclxuICAgICAgYXV0aFxyXG4gICAgKTtcclxuICAgIEdldERpc3RyaWN0V2lzZVBvc3RDb2Rlc0FwaUdhdGV3YXkoXHJcbiAgICAgIGFwaSxcclxuICAgICAgR2V0RGlzdHJpY3RXaXNlUG9zdENvZGVzTGFtYmRhQXBpLFxyXG4gICAgICBcIkdFVFwiLFxyXG4gICAgICBhdXRoXHJcbiAgICApO1xyXG5cclxuICAgIC8vIC8vIERFTEVURSBBUElTXHJcbiAgICBEZWxldGVQb3N0Y29kZXNBcGlHYXRld2F5KGFwaSwgRGVsZXRlUG9zdGNvZGVzTGFtYmRhQXBpLCBcIkRFTEVURVwiLCBhdXRoKTtcclxuICAgIERlbGV0ZVdvcmttYW5TY2hlZHVsZUFwaUdhdGV3YXkoXHJcbiAgICAgIGFwaSxcclxuICAgICAgRGVsZXRlV29ya21hblNjaGVkdWxlTGFtYmRhQXBpLFxyXG4gICAgICBcIkRFTEVURVwiLFxyXG4gICAgICBhdXRoXHJcbiAgICApO1xyXG5cclxuICAgIC8vIC8vIFVQREFURSBBUElTXHJcbiAgICBVcGRhdGVXb3Jrc21hbkRldGFpbHNBcGlHYXRld2F5KFxyXG4gICAgICBhcGksXHJcbiAgICAgIFVwZGF0ZVdvcmtzbWFuRGV0YWlsTGFtYmRhLFxyXG4gICAgICBcIlBVVFwiLFxyXG4gICAgICBhdXRoXHJcbiAgICApO1xyXG4gICAgVXBkYXRlQmFua0RldGFpbHNBcGlHYXRld2F5KGFwaSwgVXBkYXRlQmFua0RldGFpbHNMYW1iZGFBcGksIFwiUFVUXCIsIGF1dGgpO1xyXG4gIH1cclxufVxyXG4iXX0=